(()=>{"use strict";function e(){var e=document.querySelector("[data-balance]"),t=document.querySelector("[data-received]"),a=document.querySelector("[data-paid]"),n=document.getElementById("wallet-panels"),r="";e&&(r=new FormData(n),fetch("/panels",{method:"POST",body:r}).then((function(e){return e.json()})).then((function(n){console.log(n),n.balance?e.innerHTML=n.balance.toLocaleString("pt-br",{style:"currency",currency:"BRL"}):e.innerHTML="R$ 0,00",n.received?t.innerHTML=n.received.toLocaleString("pt-br",{style:"currency",currency:"BRL"}):t.innerHTML="R$ 0,00",n.paid?a.innerHTML=n.paid.toLocaleString("pt-br",{style:"currency",currency:"BRL"}):a.innerHTML="R$ 0,00"})))}function t(){document.querySelector(".ajax_load");var e=document.querySelector("#chartContainer"),t=document.getElementById("wallet-panels"),a="";e&&(a=new FormData(t),fetch("/chartdata",{method:"POST",body:a}).then((function(e){return e.json()})).then((function(t){Highcharts.setOptions({lang:{decimalPoint:",",thousandsSep:"."}}),Highcharts.chart(e,{chart:{backgroundColor:"transparent",type:"areaspline"},title:{text:"Receitas x Despesas"},subtitle:{text:""},xAxis:{categories:t.months,crosshair:!0},yAxis:{min:0,title:{text:""}},tooltip:{shared:!0,valueDecimals:2,valuePrefix:"R$ "},credits:{enabled:!1},plotOptions:{column:{pointPadding:.2,borderWidth:0}},series:[{name:"Receitas",data:t.income,color:"#61DDBC",lineColor:"#36BA9B"},{name:"Despesas",data:t.expense,color:"#f76c82",lineColor:"#D94352"}]})})))}function a(e,t){var a=document.querySelector(".alert"),n=document.createElement("div");n.classList.add("messageView",t),n.innerText=e,a.prepend(n),setTimeout((function(){n.style.display="none"}),3e3)}var n,r,o,c,i,s,l,d,u,m,f,p,y,h,g;$((function(){$("#basepath").attr("path"),$('input[name="repeat_when"]').on("click",(function(){switch($(this).val()){case"installments":$("#fixed").slideUp(),$("#installments").slideDown();break;case"fixed":$("#installments").slideUp(),$("#fixed").slideDown();break;default:$("#fixed,#installments").slideUp()}})),$(".btn-action").click((function(){var e=$(".form-step:visible"),t=$(".form-step:hidden");e.fadeOut(200,(function(){t.fadeIn(200)}))})),$(document).on("click",".pay-action",(function(){$(this).attr("class");var n=$(this).attr("data-pay"),r=$(this).attr("data-idpay"),o="";switch($(this).attr("data-type")){case"income":case"fixed_income":case"fixed_expense":o="/income/save";break;case"expense":o="/expense/save"}$(this).find("i").toggleClass("fa-check-circle fa-times-circle"),"paid"==n?$(this).attr("data-pay","unpaid"):$(this).attr("data-pay","paid"),$.post(o,{pay:n,id:r,action:"update",acao:"flash_list"},(function(n){t(),e(),n.message&&a(n.message,n.type)}),"json")})),$("#search_input").keyup((function(){var e=$(this).attr("router");search=$(this).val(),$.post(e,{search},(function(e){console.log(e),$(".result-form").html(e),$(".search_item").show(300)}))})),$(document).on("click",".search_item",(function(){var e=$(this).text();$("#search_input").val(e),$(".search_item").hide(200)})),$("[data-post]").click((function(e){e.preventDefault();var t=$(this).data(),n=$(".ajax_load");t.confirm&&!confirm(t.confirm)||$.ajax({url:t.post,type:"POST",data:t,dataType:"json",beforeSend:function(){n.fadeIn(200).css("display","flex")},success:function(e){e.redirect?window.location.href=e.redirect:n.fadeOut(200),e.reload?window.location.reload():n.fadeOut(200),e.message&&a(e.message,e.type)},error:function(){a(response.message,response.type),n.fadeOut()}})})),$("form:not('.ajax_off')").submit((function(e){e.preventDefault();var t=$(this),n=$(".ajax_load");"undefined"!=typeof tinyMCE&&tinyMCE.triggerSave(),t.ajaxSubmit({url:t.attr("action"),type:"POST",dataType:"json",beforeSend:function(){n.fadeIn(200).css("display","flex")},uploadProgress:function(e,a,n,r){var o=r,c=$(".ajax_load_box_title");c.text("Enviando ("+o+"%)"),t.find("input[type='file']").val(null),r>=100&&c.text("Aguarde, carregando...")},success:function(e){console.log(e.message),e.redirect?window.location.href=e.redirect:n.fadeOut(200),e.reload?window.location.reload():n.fadeOut(200),e.message&&a(e.message,e.type)},complete:function(){!0===t.data("reset")&&t.trigger("reset")},error:function(){a("Desculpe mas não foi possível processar sua requisição...","error"),n.fadeOut()}})})),$(".mask-date").mask("00/00/0000"),$(".mask-mobile").mask("(00)00000-0000"),$(".mask-phone").mask("(00)0000-0000"),$(".mask-datetime").mask("00/00/0000 00:00"),$(".mask-month").mask("00/0000",{reverse:!0}),$(".mask-doc").mask("000.000.000-00",{reverse:!0}),$(".mask-card").mask("0000  0000  0000  0000",{reverse:!0}),$(".mask-money").mask("000.000.000.000.000,00",{reverse:!0,placeholder:"0,00"})})),n=document.querySelector("input[data-cover=preview]"),r=document.querySelector("img[data-cover=cover-img]"),n&&n.addEventListener("change",(function(){var e=new FileReader;e.onloadend=function(){r.setAttribute("src",e.result)},n.files[0]&&e.readAsDataURL(n.files[0])})),t(),e(),(g=document.querySelector("#wallet-panels select"))&&g.addEventListener("change",(function(){e(),t()})),f=document.querySelector('[data-btn="sidebar"]'),p=document.querySelector('[data-app="content"]'),y=document.querySelector("[data-sidebar]"),h=document.querySelector('[data-btn="sidebar"] span'),f&&f.addEventListener("click",(function(){p.classList.toggle("active"),y.classList.toggle("active"),h.classList.toggle("active")})),o=document.querySelector("[data-form]"),c=document.querySelector("[data-submit]"),i=document.querySelector(".ajax_load"),s="",c&&c.addEventListener("click",(function(e){e.preventDefault();var t=o.getAttribute("action"),n={email:(s=new FormData(o)).get("email"),remember:!0};s.get("remember")?localStorage.setItem("login",JSON.stringify(n)):localStorage.removeItem("login"),i.classList.add("ajax_load_flex"),fetch(t,{method:"POST",body:s}).then((function(e){return i.classList.remove("ajax_load_flex"),e.json()})).then((function(e){e.redirect?window.location.href=e.redirect:a(e.message,e.type)}))})),l=document.querySelector("[data-form] input[type=checkbox]"),d=document.querySelector("[data-form] input[name=email]"),u=localStorage.getItem("login"),m=JSON.parse(u),null!=d&&null!=m&&(d.value=m.email,l.checked=!0),document.querySelectorAll("[data-register='expense']").forEach((function(e){e.style.color="red"})),function(){var e=document.getElementById("extract"),t=document.getElementById("extractBtn"),n=document.getElementById("tbody"),r=document.getElementById("totalExtract");e&&t.addEventListener("click",(function(t){t.preventDefault();var o=new FormData(e);if(o.get("date1"))if(o.get("date2"))if(o.get("wallet")){var c={method:"POST",body:o};document.querySelector(".ajax_load").classList.add("ajax_load_flex"),fetch("/extrato-filter",c).then((function(e){return document.querySelector(".ajax_load").classList.remove("ajax_load_flex"),e.json()})).then((function(e){n.innerHTML="",r.innerHTML="";var t="",a="";e.result.forEach((function(e){a=!0===e.status?' <p data-pay="unpaid" \n                                            data-type="expense" \n                                            data-idpay="'.concat(e.id,'"\n                                            class="pay-action"> \n                                                <i class="fas fa-check-circle"></i>\n                                          </p>'):' <p data-pay="paid" \n                                            data-type="expense" \n                                            data-idpay="'.concat(e.id,'"\n                                            class="pay-action"> \n                                                <i class="fas fa-times-circle"></i>\n                                        </p>'),t+="<tr>\n                                        <td>".concat(e.date,"</td>\n                                        <td>").concat(e.description,"</td>\n                                        <td ").concat("expense"==e.type?"style='color:red'":"",">").concat(e.value,"</td>\n                                        <td>").concat(a,'</td>\n                                        <td>\n                                            <a href="/').concat(e.router,"?id=").concat(e.id,'">\n                                                <i class="fas fa-edit"></i>\n                                            </a>\n                                        </td>\n                                    </tr>')})),n.innerHTML=t,r.innerHTML=e.total.toLocaleString("pt-br",{style:"currency",currency:"BRL"})})).catch((function(e){console.log(e)}))}else a("Escolha uma carteira","error");else a("falta preencher a data Final","error");else a("Falta preencher a data inicial","error")}))}()})();