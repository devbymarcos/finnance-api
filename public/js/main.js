(()=>{"use strict";function e(){var e=document.querySelector("[data-balance]"),t=document.querySelector("[data-received]"),a=document.querySelector("[data-paid]"),n=(document.querySelector("[data-balanceMonth]"),document.getElementById("wallet-panels")),s="";e&&(s=new FormData(n),fetch("/panels",{method:"POST",body:s}).then((function(e){return e.json()})).then((function(n){console.log(n),n.balance?e.innerHTML=n.balance.toLocaleString("pt-br",{style:"currency",currency:"BRL"}):e.innerHTML="R$ 0,00",n.received?t.innerHTML=n.received.toLocaleString("pt-br",{style:"currency",currency:"BRL"}):t.innerHTML="R$ 0,00",n.paid?a.innerHTML=n.paid.toLocaleString("pt-br",{style:"currency",currency:"BRL"}):a.innerHTML="R$ 0,00"})))}function t(){document.querySelector(".ajax_load");var e=document.querySelector("#chartContainer"),t=document.getElementById("wallet-panels"),a="";e&&(a=new FormData(t),fetch("/chartdata",{method:"POST",body:a}).then((function(e){return e.json()})).then((function(t){Highcharts.setOptions({lang:{decimalPoint:",",thousandsSep:"."}}),Highcharts.chart(e,{chart:{backgroundColor:"transparent",type:"areaspline"},title:{text:"Receitas x Despesas"},subtitle:{text:""},xAxis:{categories:t.months,crosshair:!0},yAxis:{min:0,title:{text:""}},tooltip:{shared:!0,valueDecimals:2,valuePrefix:"R$ "},credits:{enabled:!1},plotOptions:{column:{pointPadding:.2,borderWidth:0}},series:[{name:"Receitas",data:t.income,color:"#61DDBC",lineColor:"#36BA9B"},{name:"Despesas",data:t.expense,color:"#f76c82",lineColor:"#D94352"}]})})))}var a,n,s,i,c,o,r;$((function(){$("#basepath").attr("path");var a=3;function n(e,t){var a=$(e);a.append("<div class='message_time'></div>"),a.find(".message_time").animate({width:"100%"},1e3*t,(function(){$(this).parents(".message").fadeOut(200)})),$(".ajax_response").append(a),a.effect("slide")}$('input[name="repeat_when"]').on("click",(function(){switch($(this).val()){case"installments":$("#fixed").slideUp(),$("#installments").slideDown();break;case"fixed":$("#installments").slideUp(),$("#fixed").slideDown();break;default:$("#fixed,#installments").slideUp()}})),$(".btn-action").click((function(){var e=$(".form-step:visible"),t=$(".form-step:hidden");e.fadeOut(200,(function(){t.fadeIn(200)}))})),$(document).on("click",".pay-action",(function(){$(this).attr("class");var s=$(this).attr("data-pay"),i=$(this).attr("data-idpay"),c="";switch($(this).attr("data-type")){case"income":case"fixed_income":case"fixed_expense":c="/income/save";break;case"expense":c="/expense/save"}$(this).find("i").toggleClass("fa-check-circle fa-times-circle"),"paid"==s?$(this).attr("data-pay","unpaid"):$(this).attr("data-pay","paid"),$.post(c,{pay:s,id:i,action:"update",acao:"flash_list"},(function(s){t(),e(),s.message&&n("<div class='message ".concat(s.type,"'>").concat(s.message,"</div>"),a)}),"json")})),$("#search_input").keyup((function(){var e=$(this).attr("router");search=$(this).val(),$.post(e,{search},(function(e){console.log(e),$(".result-form").html(e),$(".search_item").show(300)}))})),$(document).on("click",".search_item",(function(){var e=$(this).text();$("#search_input").val(e),$(".search_item").hide(200)})),$("[data-post]").click((function(e){e.preventDefault();var t=$(this).data(),s=$(".ajax_load");t.confirm&&!confirm(t.confirm)||$.ajax({url:t.post,type:"POST",data:t,dataType:"json",beforeSend:function(){s.fadeIn(200).css("display","flex")},success:function(e){e.redirect?window.location.href=e.redirect:s.fadeOut(200),e.reload?window.location.reload():s.fadeOut(200),e.message&&n("<div class='message ".concat(e.type,"'>").concat(e.message,"</div>"),a)},error:function(){n("<div class='message error icon-warning'>Desculpe mas não foi possível processar sua requisição...</div>",5),s.fadeOut()}})})),$("form:not('.ajax_off')").submit((function(e){e.preventDefault();var t=$(this),s=$(".ajax_load");"undefined"!=typeof tinyMCE&&tinyMCE.triggerSave(),t.ajaxSubmit({url:t.attr("action"),type:"POST",dataType:"json",beforeSend:function(){s.fadeIn(200).css("display","flex")},uploadProgress:function(e,a,n,s){var i=s,c=$(".ajax_load_box_title");c.text("Enviando ("+i+"%)"),t.find("input[type='file']").val(null),s>=100&&c.text("Aguarde, carregando...")},success:function(e){console.log(e.message),e.redirect?window.location.href=e.redirect:s.fadeOut(200),e.reload?window.location.reload():s.fadeOut(200),e.message&&n("<div class='message ".concat(e.type,"'>").concat(e.message,"</div>"),a)},complete:function(){!0===t.data("reset")&&t.trigger("reset")},error:function(){n("<div class='message error icon-warning'>Desculpe mas não foi possível processar sua requisição...</div>",5),s.fadeOut()}})})),$(".ajax_response .message").each((function(e,t){n(t,a+=1)})),$(".ajax_response").on("click",".message",(function(e){$(this).effect("bounce").fadeOut(1)}))})),a=document.querySelector("input[data-cover=preview]"),n=document.querySelector("img[data-cover=cover-img]"),a&&a.addEventListener("change",(function(){var e=new FileReader;e.onloadend=function(){n.setAttribute("src",e.result)},a.files[0]&&e.readAsDataURL(a.files[0])})),t(),e(),(r=document.querySelector("#wallet-panels select"))&&r.addEventListener("change",(function(){e(),t()})),s=document.querySelector('[data-btn="sidebar"]'),i=document.querySelector('[data-app="content"]'),c=document.querySelector("[data-sidebar]"),o=document.querySelector('[data-btn="sidebar"] span'),s&&s.addEventListener("click",(function(){i.classList.toggle("active"),c.classList.toggle("active"),o.classList.toggle("active")}))})();