(()=>{"use strict";function e(){var e=document.querySelector("[data-balance]"),t=document.querySelector("[data-received]"),a=document.querySelector("[data-paid]"),n=document.querySelector("[data-balanceMonth]");e&&fetch("/panels").then((function(e){return e.json()})).then((function(o){o?(e.innerHTML=o.balance.toLocaleString("pt-br",{style:"currency",currency:"BRL"}),t.innerHTML=o.received.toLocaleString("pt-br",{style:"currency",currency:"BRL"}),a.innerHTML=o.paid.toLocaleString("pt-br",{style:"currency",currency:"BRL"}),n.innerHTML=o.balanceMonth.toLocaleString("pt-br",{style:"currency",currency:"BRL"})):(e.innerHTML="R$ 0,00",t.innerHTML="R$ 0,00",a.innerHTML="R$ 0,00",balanceMotnh.innerHTML="R$ 0,00")}))}function t(){document.querySelector(".ajax_load");var e=document.querySelector("#chartContainer");e&&fetch("/chartdata").then((function(e){return e.json()})).then((function(t){Highcharts.setOptions({lang:{decimalPoint:",",thousandsSep:"."}}),Highcharts.chart(e,{chart:{backgroundColor:"transparent",type:"areaspline"},title:{text:"Receitas x Despesas"},subtitle:{text:""},xAxis:{categories:t.months,crosshair:!0},yAxis:{min:0,title:{text:""}},tooltip:{shared:!0,valueDecimals:2,valuePrefix:"R$ "},credits:{enabled:!1},plotOptions:{column:{pointPadding:.2,borderWidth:0}},series:[{name:"Receitas",data:t.income,color:"#61DDBC",lineColor:"#36BA9B"},{name:"Despesas",data:t.expense,color:"#f76c82",lineColor:"#D94352"}]})}))}var a,n,o,r,i,c,s,l;!function(){var a,n;$((function(){$("#basepath").attr("path");var a=3;function n(e,t){var a=$(e);a.append("<div class='message_time'></div>"),a.find(".message_time").animate({width:"100%"},1e3*t,(function(){$(this).parents(".message").fadeOut(200)})),$(".ajax_response").append(a),a.effect("slide")}$('input[name="repeat_when"]').on("click",(function(){switch($(this).val()){case"installments":$("#fixed").slideUp(),$("#installments").slideDown();break;case"fixed":$("#installments").slideUp(),$("#fixed").slideDown();break;default:$("#fixed,#installments").slideUp()}})),$(".btn-action").click((function(){var e=$(".form-step:visible"),t=$(".form-step:hidden");e.fadeOut(200,(function(){t.fadeIn(200)}))})),$(document).on("click",".pay-action",(function(){$(this).attr("class");var o=$(this).attr("data-pay"),r=$(this).attr("data-idpay"),i="";switch($(this).attr("data-type")){case"income":case"fixed_income":case"fixed_expense":i="/income/save";break;case"expense":i="/expense/save"}$(this).find("i").toggleClass("fa-check-circle fa-times-circle"),"paid"==o?$(this).attr("data-pay","unpaid"):$(this).attr("data-pay","paid"),$.post(i,{pay:o,id:r,action:"update",acao:"flash_list"},(function(o){t(),e(),o.message&&n("<div class='message ".concat(o.type,"'>").concat(o.message,"</div>"),a)}),"json")})),$("#search_input").keyup((function(){var e=$(this).attr("router");search=$(this).val(),$.post(e,{search},(function(e){console.log(e),$(".result-form").html(e),$(".search_item").show(300)}))})),$(document).on("click",".search_item",(function(){var e=$(this).text();$("#search_input").val(e),$(".search_item").hide(200)})),$("[data-post]").click((function(e){e.preventDefault();var t=$(this).data(),o=$(".ajax_load");t.confirm&&!confirm(t.confirm)||$.ajax({url:t.post,type:"POST",data:t,dataType:"json",beforeSend:function(){o.fadeIn(200).css("display","flex")},success:function(e){e.redirect?window.location.href=e.redirect:o.fadeOut(200),e.reload?window.location.reload():o.fadeOut(200),e.message&&n("<div class='message ".concat(e.type,"'>").concat(e.message,"</div>"),a)},error:function(){n("<div class='message error icon-warning'>Desculpe mas não foi possível processar sua requisição...</div>",5),o.fadeOut()}})})),$("form:not('.ajax_off')").submit((function(e){e.preventDefault();var t=$(this),o=$(".ajax_load");"undefined"!=typeof tinyMCE&&tinyMCE.triggerSave(),t.ajaxSubmit({url:t.attr("action"),type:"POST",dataType:"json",beforeSend:function(){o.fadeIn(200).css("display","flex")},uploadProgress:function(e,a,n,o){var r=o,i=$(".ajax_load_box_title");i.text("Enviando ("+r+"%)"),t.find("input[type='file']").val(null),o>=100&&i.text("Aguarde, carregando...")},success:function(e){console.log(e.message),e.redirect?window.location.href=e.redirect:o.fadeOut(200),e.reload?window.location.reload():o.fadeOut(200),e.message&&n("<div class='message ".concat(e.type,"'>").concat(e.message,"</div>"),a)},complete:function(){!0===t.data("reset")&&t.trigger("reset")},error:function(){n("<div class='message error icon-warning'>Desculpe mas não foi possível processar sua requisição...</div>",5),o.fadeOut()}})})),$(".ajax_response .message").each((function(e,t){n(t,a+=1)})),$(".ajax_response").on("click",".message",(function(e){$(this).effect("bounce").fadeOut(1)}))})),a=document.querySelector("input[data-cover=preview]"),n=document.querySelector("img[data-cover=cover-img]"),a&&a.addEventListener("change",(function(){var e=new FileReader;e.onloadend=function(){n.setAttribute("src",e.result)},a.files[0]&&e.readAsDataURL(a.files[0])}));var o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;e.style.transitionProperty="height, margin, padding",e.style.transitionDuration=t+"ms",e.style.boxSizing="border-box",e.style.height=e.offsetHeight+"px",e.offsetHeight,e.style.overflow="hidden",e.style.height=0,e.style.paddingTop=0,e.style.paddingBottom=0,e.style.marginTop=0,e.style.marginBottom=0,window.setTimeout((function(){e.style.display="none",e.style.removeProperty("height"),e.style.removeProperty("padding-top"),e.style.removeProperty("padding-bottom"),e.style.removeProperty("margin-top"),e.style.removeProperty("margin-bottom"),e.style.removeProperty("overflow"),e.style.removeProperty("transition-duration"),e.style.removeProperty("transition-property")}),t)},r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;e.style.removeProperty("display");var a=window.getComputedStyle(e).display;"none"===a&&(a="block"),e.style.display=a;var n=e.offsetHeight;e.style.overflow="hidden",e.style.height=0,e.style.paddingTop=0,e.style.paddingBottom=0,e.style.marginTop=0,e.style.marginBottom=0,e.offsetHeight,e.style.boxSizing="border-box",e.style.transitionProperty="height, margin, padding",e.style.transitionDuration=t+"ms",e.style.height=n+"px",e.style.removeProperty("padding-top"),e.style.removeProperty("padding-bottom"),e.style.removeProperty("margin-top"),e.style.removeProperty("margin-bottom"),window.setTimeout((function(){e.style.removeProperty("height"),e.style.removeProperty("overflow"),e.style.removeProperty("transition-duration"),e.style.removeProperty("transition-property")}),t)},i=document.querySelector(".btn-mobile"),c=document.querySelector(".navigation__mobile");i&&i.addEventListener("click",(function(){!function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;"none"===window.getComputedStyle(e).display?r(e,t):o(e,t)}(c)}))}(),a=document.querySelector('[data-search="cashFlow"]'),n=document.querySelector('[data-form-search="cashFlow"]'),document.querySelector('[data-table="body"]'),o=document.querySelectorAll("[data-id]"),r=document.querySelector('[data-tb="tb-income"]'),i=document.querySelector('[data-tb="tb-expense"]'),c=document.querySelector('[data-tb="tb-balance"]'),s=document.querySelector(".ajax_load"),l=document.querySelector('[data-table="th"]'),a&&a.addEventListener("click",(function(e){e.preventDefault(),document.querySelectorAll("[data-id] td:not([data-name])").forEach((function(e){e.remove()})),document.querySelectorAll('[data-table="th"] th:not([data-name])').forEach((function(e){e.remove()})),document.querySelectorAll("[data-tb] td:not([data-name])").forEach((function(e){e.remove()}));var t=new FormData(n);s.classList.add("ajax_load_flex"),fetch("/fluxo-data",{method:"POST",body:t}).then((function(e){return 204===e.status?(s.classList.remove("ajax_load_flex"),void alert("não ha dados")):e.json()})).then((function(e){s.classList.remove("ajax_load_flex");var t=function(e){var t,a=e.Group,n=e.By,o=function(e){var t,a=[];for(t=0;t<n.length;t++)a.push(e[n[t]]);return a},r={};for(t=0;t<a.length;t++){var i=a[t],c=JSON.stringify(o(i));r[c]=r[c]||[],r[c].push(i)}return Object.keys(r).map((function(e){return r[e]}))}({Group:e[1],By:["mes"]});function a(e,t,a){var n=document.createElement(e);n.textContent=t,a.appendChild(n)}a("td",e[2].tIncome.toLocaleString("pt-br",{style:"currency",currency:"BRL"}),r),a("td",e[2].tExpense.toLocaleString("pt-br",{style:"currency",currency:"BRL"}),i),a("td",e[2].tBalance.toLocaleString("pt-br",{style:"currency",currency:"BRL"}),c),e[0].forEach((function(e){var t=document.createElement("th");t.textContent=e.nome,t.setAttribute("data-mes",e.id),l.appendChild(t)})),o.forEach((function(e){t.forEach((function(t,a,n){for(var o=0;o<t.length;o++)if(t[o].codigo===parseInt(e.dataset.id)){var r=document.createElement("td");r.textContent=t[o].preco.toLocaleString("pt-br",{style:"currency",currency:"BRL"}),e.appendChild(r)}}))}))})).catch((function(e){console.log("sem dados para analizar:",e)}))})),function(){var e=document.querySelector('[data-select="year"]');if(e){for(var t=[],a=new Date,n=1;n<13;n++)t.push({month:n+"/"+a.getFullYear()});t.forEach((function(t){e.appendChild(new Option(t.month,t.month))}))}}(),t(),e()})();